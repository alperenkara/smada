#Advanced Statistics 2018
#LAB12 Regression part2
#GENERAL 
#Alperen KARA

?swiss
data("swiss")

cor(swiss)

round(cor(swiss), 2)

cor.test(swiss$Fertility, swiss$Education)

install.packages("Hmisc")
require("Hmisc")

rcorr(as.matrix(swiss))

?trees

data(trees)

trees[1:5, ]

hist(trees$Height)
hist(trees$Girth)
plot(trees$Girth, trees$Height)

abline(lm(trees$Height ~ trees$Girth))

reg1 <- lm(Height ~ Girth, data = trees)
reg1
#Coefficients:
#(Intercept)        Girth  
#62.031        1.054

summary(reg1)
# Residuals:
#   Min       1Q   Median       3Q      Max 
# -12.5816  -2.7686   0.3163   2.4728   9.9456 
# 
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)    
# (Intercept)  62.0313     4.3833  14.152 1.49e-14 ***
#   Girth         1.0544     0.3222   3.272  0.00276 ** 
#   ---
#   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
# 
# Residual standard error: 5.538 on 29 degrees of freedom
# Multiple R-squared:  0.2697,	Adjusted R-squared:  0.2445 
# F-statistic: 10.71 on 1 and 29 DF,  p-value: 0.002758

confint(reg1)

# 2.5 %    97.5 %
#   (Intercept) 53.0664541 70.996174
# Girth        0.3953483  1.713389

predict(reg1)

# 1        2        3        4        5        6        7        8        9       10 
# 70.78257 71.09889 71.30976 73.10219 73.31306 73.41850 73.62937 73.62937 73.73481 73.84024 
# 11       12       13       14       15       16       17       18       19       20 
# 73.94568 74.05112 74.05112 74.36743 74.68374 75.63267 75.63267 76.05442 76.47617 76.58160 
# 21       22       23       24       25       26       27       28       29       30 
# 76.79248 77.00335 77.31966 78.90121 79.21753 80.27189 80.48277 80.90452 81.00995 81.00995 
# 31 

predict(reg1, interval = "prediction")
# fit      lwr      upr
# 1  70.78257 58.82078 82.74437
# 2  71.09889 59.18947 83.00830
# 3  71.30976 59.43356 83.18596
# 4  73.10219 61.45184 84.75253
# 5  73.31306 61.68248 84.94364
# 6  73.41850 61.79725 85.03975
# 7  73.62937 62.02569 85.23305
# 8  73.62937 62.02569 85.23305
# 9  73.73481 62.13936 85.33026
# 10 73.84024 62.25266 85.42783
# 11 73.94568 62.36558 85.52578
# 12 74.05112 62.47814 85.62409
# 13 74.05112 62.47814 85.62409
# 14 74.36743 62.81359 85.92127
# 15 74.68374 63.14568 86.22180
# 16 75.63267 64.12169 87.14365
# 17 75.63267 64.12169 87.14365
# 18 76.05442 64.54568 87.56316
# 19 76.47617 64.96363 87.98870
# 20 76.58160 65.06717 88.09603
# 21 76.79248 65.27313 88.31182
# 22 77.00335 65.47759 88.52911
# 23 77.31966 65.78145 88.85787
# 24 78.90121 67.25054 90.55189
# 25 79.21753 67.53445 90.90060
# 26 80.27189 68.45752 92.08626
# 27 80.48277 68.63791 92.32762
# 28 80.90452 68.99455 92.81448
# 29 81.00995 69.08286 92.93705
# 30 81.00995 69.08286 92.93705
# 31 83.75131 71.26441 96.23821

